!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var i;i="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,i.Diagramy=t()}}(function(){return function t(i,e,s){function n(o,a){if(!e[o]){if(!i[o]){var l="function"==typeof require&&require;if(!a&&l)return l(o,!0);if(r)return r(o,!0);var h=new Error("Cannot find module '"+o+"'");throw h.code="MODULE_NOT_FOUND",h}var c=e[o]={exports:{}};i[o][0].call(c.exports,function(t){var e=i[o][1][t];return n(e?e:t)},c,c.exports,t,i,e,s)}return e[o].exports}for(var r="function"==typeof require&&require,o=0;o<s.length;o++)n(s[o]);return n}({1:[function(t,i,e){(function(e){var s;!function(t){"use strict"}(s||(s={}));var s;!function(t){"use strict"}(s||(s={}));var s;!function(t){"use strict"}(s||(s={}));var s;!function(t){"use strict";var i=function(){function t(t,i){void 0===t&&(t=0),void 0===i&&(i=0),this.x=t,this.y=i}return t.prototype.v=function(){return[this.x,this.y]},t.prototype.distance=function(t){return Math.floor((Math.abs(this.x-t.x)+Math.abs(this.y-t.y))/2)},t.prototype.toString=function(){return this.x+","+this.y},t.prototype.equals=function(t){return this.x===t.x&&this.y===t.y},t.prototype.add=function(i){return new t(this.x+i.x,this.y+i.y)},t.prototype.scale=function(i){return new t(this.x*i,this.y*i)},t.prototype.cubeLength=function(){return Math.floor((Math.abs(this.x)+Math.abs(this.y))/2)},t}();t.Integer2=i}(s||(s={}));var s;!function(t){"use strict"}(s||(s={}));var s;!function(t){"use strict";var i=function(){function i(t,i){void 0===t&&(t=0),void 0===i&&(i=0),this.x=t,this.y=i}return i.round=function(i){var e=Math.round(i.x),s=Math.round(i.y);return new t.Integer2(e,s)},i.lerp=function(t,e,s){return new i(t.x+(e.x-t.x)*s,t.y+(e.y-t.y)*s)},i.line=function(t,e){for(var s=t.distance(e),n=[],r=0;s+1>r;r++)n.push(i.round(i.lerp(t,e,1/Math.max(1,s)*r)));return n},i.prototype.equals=function(t){return this.x===t.x&&this.y===t.y},i.prototype.v=function(){return[this.x,this.y]},i.prototype.scale=function(t){return new i(this.x*t,this.y*t)},i.prototype.toString=function(){return this.v().join(",")},i}();t.Float2=i}(s||(s={}));var s,n=this.__extends||function(t,i){function e(){this.constructor=t}for(var s in i)i.hasOwnProperty(s)&&(t[s]=i[s]);e.prototype=i.prototype,t.prototype=new e};!function(t){"use strict";var i=function(t){function i(){t.apply(this,arguments)}return n(i,t),i}(t.Integer2);t.Position=i}(s||(s={}));var s;!function(t){"use strict";var i=function(){function t(t,i,e,s){void 0===t&&(t=0),void 0===i&&(i=0),void 0===e&&(e=0),void 0===s&&(s=0),this.minX=0,this.maxX=0,this.minY=0,this.maxY=0,this.minX=t,this.maxX=i,this.minY=e,this.maxY=s}return t.add=function(i,e){return new t(i.minX+e.minX,i.maxX+e.maxX,i.minY+e.minY,i.maxY+e.maxY)},t}();t.Rectangle=i}(s||(s={}));var s;!function(t){"use strict"}(s||(s={}));var s;!function(t){"use strict";var i=function(){function t(t,i,e,s,n){var r=this;void 0===n&&(n=null),this.cost={},this.previous={},this.max=0,this.start=t,this.cost[t.toString()]=0,this.previous[t.toString()]=null;for(var o=[[t]],a=0;i>a&&o[a].length>0;a++)o[a+1]=[],o[a].forEach(function(t){for(var i=t.neighbors(),l=0;l<i.length;l++){var h=i[l];(!n||n[h.toString()])&&void 0===r.cost[h.toString()]&&!s[h.toString()]&&h.cubeLength()<=e&&(r.cost[h.toString()]=a+1,r.max=Math.max(r.max,a+1),r.previous[h.toString()]=t,o[a+1].push(h))}})}return t.prototype.path=function(t){for(var i=[],e=t;e;)i.push(e),e=e.equals(this.start)?null:this.previous[e.toString()];return i},t}();t.Search=i}(s||(s={}));var r;!function(i){"use strict";var n=e.d3||t("d3"),r=function(){function t(t,i,e){void 0===e&&(e=!0),this.fontSize=14,this.duration=0,this.data={},this._polygons=!0,this._centers=!1,this._circles=!1,this._coordinates=!1,this._tileCoordinates=!1,this.svg=t,this.grid=i,this.animation=e,this.root=t.append("g"),this.paths=t.append("g"),this.init()}return t.prototype.init=function(){this.nodes&&(this.duration=800),this.initRoot();var t=this.initTiles();return this._polygons&&this.polygons(t),this._centers&&this.centers(t),this._circles&&this.circles(t),this._coordinates&&this.coordinates(t),this._tileCoordinates&&this.tileCoordinates(t),this},t.prototype.polygons=function(t){var i=this;void 0===t&&(t=!0);var e;if(t===!1)return this.tiles.selectAll("g.polygon").selectAll("polygon").remove(),this._polygons=!1,this;t!==!0||this._polygons?t!==!0&&(e=t.selectAll("g.polygon"),e.append("polygon")):(e=this.tiles.selectAll("g.polygon"),e.append("polygon"),this._polygons=!0);for(var s=this.tiles.selectAll("g.polygon").selectAll("polygon"),n=[],r=0;r<this.grid.tileTypes;r++)n.push(this.shapePath(r));return 1===this.grid.tileTypes?s.attr("points",n[0]):s.attr("points",function(t){return n[i.grid.getTileType(i.data[t].tile)]}),this.transition(s).attr("transform","rotate("+this.grid.orientation*this.grid.angle+")"),this},t.prototype.centers=function(t){void 0===t&&(t=!0);var i;return t===!1?(this.tiles.selectAll("g.center").selectAll("circle").remove(),this._centers=!1,this):(t!==!0||this._centers?t!==!0&&(i=t.selectAll("g.center"),i.append("circle").attr("class","center").attr("r",5)):(i=this.tiles.selectAll("g.center"),i.append("circle").attr("class","center").attr("r",5),this._centers=!0),this)},t.prototype.circles=function(t){void 0===t&&(t=!0);var i;return t===!1?(this.tiles.selectAll("g.circle").selectAll("circle").remove(),this._circles=!1,this):(t!==!0||this._circles?t!==!0&&(i=t.selectAll("g.circle"),i.append("circle").attr("class","circle")):(i=this.tiles.selectAll("g.circle"),i.append("circle").attr("class","circle"),this._circles=!0),this.transition(this.tiles.selectAll("g.circle").selectAll("circle")).attr("r",this.grid.radius),this)},t.prototype.coordinates=function(t){void 0===t&&(t=!0);var i;if(t===!1)return this.tiles.selectAll("g.coordinates").selectAll("text").remove(),this._coordinates=!1,this;if(t!==!0||this._coordinates?t!==!0&&(i=t.selectAll("g.coordinates")):(i=this.tiles.selectAll("g.coordinates"),this._coordinates=!0),i){var e=this;i.append("text").attr("y","0.4em").each(function(t){var i=e.grid.toPoint(e.data[t].tile),s=n.select(this);s.append("tspan").attr("class","x").text(i.x),s.append("tspan").text(", "),s.append("tspan").attr("class","y").text(i.y)})}return this},t.prototype.tileCoordinates=function(t){void 0===t&&(t=!0);var i;if(t===!1)return this.tiles.selectAll("g.tile-coordinates").selectAll("text").remove(),this._tileCoordinates=!1,this;if(t!==!0||this._tileCoordinates?t!==!0&&(this.tiles.selectAll("g.tile-coordinates").selectAll("text").remove(),i=this.tiles.selectAll("g.tile-coordinates")):(i=this.tiles.selectAll("g.tile-coordinates"),this._tileCoordinates=!0),i){var e=this;i.append("text").attr("y","0.4em").each(function(t){var i=n.select(this),s=e.data[t].tile.v();0===s[0]&&0===s[1]&&0===s[2]&&(s=["x","y","z"]),s[2]===!0?s[2]="T":s[2]===!1&&(s[2]="F"),i.append("tspan").attr("class","q").text(s[0]),i.append("tspan").attr("class","s").text(s[1]),i.append("tspan").attr("class","r").text(s[2])});var s=this.grid.vertices(this.grid.orientation,this.grid.scale-1.5*this.fontSize);this.tiles.select(".q").attr("x",s[0].x).attr("y",s[0].y+.4*this.fontSize),this.tiles.select(".s").attr("x",s[2].x).attr("y",s[2].y+.4*this.fontSize),s.length>4?this.tiles.select(".r").attr("x",s[4].x).attr("y",s[4].y+.4*this.fontSize):s.length>=3&&this.tiles.select(".r").attr("x",s[1].x).attr("y",s[1].y+.4*this.fontSize)}return this},t.prototype.highlight=function(t,i){var e=this;void 0===i&&(i="highlight");var s=n.set(t);return this.tiles.classed(i,function(t){return s.has(e.data[t].tile)}),this},t.prototype.path=function(t){if(this.paths.selectAll("*").remove(),!t||!t.length)return this;for(var i=this.paths.append("path").attr("d","M 0 0").attr("class","path"),e=[],s=0;s<t.length;s++)e.push(0===s?"M":"L"),e.push(this.grid.center(t[s]).toString());return i.attr("d",e.join(" ")),this},t.prototype.search=function(t,i,e){var s=this;if(void 0===i&&(i="hsl(90, 80%, 80%)"),void 0===e&&(e="hsl(200, 80%, 80%)"),!t)return this.tiles.selectAll("g.polygon").selectAll("polygon").style("fill",null),this;var r=n.interpolate(i,e);return this.tiles.selectAll("g.polygon").selectAll("polygon").style("fill",function(i){var e=t.cost[s.data[i].key];return e>=0?r(e/(t.max||1)):null}),this},t.prototype.point=function(t){var i=this;this.pointElement||(this.pointElement=this.svg.append("circle"),this.pointElement.attr("class","marker").attr("r",5));var e=this.grid.position(new s.Float2(t[0],t[1]));return this.pointElement.attr("transform","translate("+(t[0]+this.translate.x)+","+(t[1]+this.translate.y)+")"),this.tiles.classed("highlight",function(t){return i.data[t].tile.equals(e)}),this},t.prototype.mousePoint=function(){var t=this;return this.svg.on("mousemove",function(){var i=n.mouse(t.root.node());t.point(i)}),this},t.prototype.initRoot=function(){var t=this.grid.bounds();this.translate=new s.Float2((parseFloat(this.svg.attr("width"))-t.minX-t.maxX)/2,(parseFloat(this.svg.attr("height"))-t.minY-t.maxY)/2),this.transition(this.root).attr("transform","translate("+this.translate+")"),this.transition(this.paths).attr("transform","translate("+this.translate+")")},t.prototype.initTiles=function(){var t=this;this.nodes=this.grid.tiles.map(function(i){var e={tile:i,key:i.toString(),tileKey:t.grid.toPoint(i).toString()};return t.data[e.tileKey]=e,e.tileKey}),this.tiles=this.root.selectAll("g.tile").data(this.nodes,function(t){return t}),this.transition(this.tiles.exit(),.5).style("opacity",0).remove();var i=this.tiles.enter().append("g").attr("class","tile").style("opacity",this.animation?0:1).attr("transform",function(i){var e=t.grid.center(t.data[i].tile);return"translate("+e.x+","+e.y+")"});return i.append("g").attr("class","polygon").empty(),i.append("g").attr("class","center").empty(),i.append("g").attr("class","circle").empty(),i.append("g").attr("class","coordinates").empty(),i.append("g").attr("class","tile-coordinates").empty(),this.transition(this.tiles).attr("transform",function(i){var e=t.grid.center(t.data[i].tile);return"translate("+e.x+","+e.y+")"}).style("opacity",1),i},t.prototype.shapePath=function(t){return this.grid.vertices(null,null,t).map(function(t){return t.x.toFixed(3)+","+t.y.toFixed(3)}).join(" ")},t.prototype.transition=function(t,i){return void 0===i&&(i=1),this.animation&&this.duration*i?t.transition().duration(this.duration*i):t},t}();i.Diagram=r}(r||(r={})),i.exports=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{d3:void 0}]},{},[1])(1)});
//# sourceMappingURL=diagramy.min.js.map